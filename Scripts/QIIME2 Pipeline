# Importing and demultiplexing the filtered Halfvarson manifest file
qiime tools import \
  --type "SampleData[SequencesWithQuality]" \
  --input-format SingleEndFastqManifestPhred33V2 \
  --input-path halfvarson_manifest_filtered.tsv \
  --output-path ./halfvarson_demux_seqs.qza

qiime demux summarize \
  --i-data halfvarson_demux_seqs.qza \
  --o-visualization halfvarson_demux_seqs.qzv

# Halfvarson Denoising using DADA2
qiime dada2 denoise-single \
  --i-demultiplexed-seqs halfvarson_demux_seqs.qza \
  --p-trim-left 0 \
  --p-trunc-len 99 \
  --o-representative-sequences halfvarson_rep-seqs.qza \
  --o-table halfvarson_table.qza \
  --o-denoising-stats halfvarson_stats.qza

# Importing and demultiplexing the filtered p4 manifest file
qiime tools import \
  --type "SampleData[PairedEndSequencesWithQuality]" \
  --input-format PairedEndFastqManifestPhred33V2 \
  --input-path Mintz_P4_manifest_filtered.tsv \
  --output-path ./Mintz_P4_demux_seqs.qza

qiime demux summarize \
  --i-data Mintz_P4_demux_seqs.qza \
  --o-visualization Mintz_P4_demux_seqs.qzv


# Merge tables
qiime feature-table merge \
 --i-tables /home/.qza \
 --i-tables table2.qza \
 --o-merged-table merged_table.qza

# Merge rep-seqs
qiime feature-table merge-seqs \
 --i-data may_rep-seqs.qza \
 --i-data july_rep-seqs.qza \
 --i-data septoct_rep-seqs.qza \
 --i-data psomagen_2_rep-seqs.qza \
 --o-merged-data merged_rep-seqs.qza

# Merge taxonomy files
qiime feature-table merge-taxa-data \
  --i-data1 analysis1/taxonomy.qza \
  --i-data2 analysis2/taxonomy.qza \
  --o-merged-data merged-taxonomy.qza
